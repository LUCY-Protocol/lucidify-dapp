<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>LUCIDIFY (LUCY) â€“ Presale dApp</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<style>
body {background:#050816;color:#fff;font-family:sans-serif;overflow-x:hidden;}
.bg-neon {background:radial-gradient(circle at 20% 20%, rgba(0,255,120,.25), transparent 60%),
                       radial-gradient(circle at 80% 80%, rgba(255,230,0,.25), transparent 60%);}
.glass {background:rgba(255,255,255,.04);backdrop-filter:blur(18px);border:1px solid rgba(255,255,255,.1);}
button:disabled {opacity:.4;cursor:not-allowed;}
</style>

</head>
<body class="bg-neon min-h-screen">

<div id="root"></div>

<script>
const {useState,useEffect}=React;

// ---------------- CONFIG ----------------

const PRESALE_ADDRESS="REPLACE_WITH_YOUR_CONTRACT";
const RATE = 100; // 1 MATIC = X LUCY
const PRESALE_ABI=[/* ---- PASTE ABI HERE ---- */];

// ---------------- WALLET CONNECT ----------------

async function connectWallet(){
  if(!window.ethereum) return alert("Install MetaMask first.");

  const provider=new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts",[]);
  const signer=provider.getSigner();
  const addr=await signer.getAddress();

  return {provider,signer,addr};
}

// ---------------- BUY FUNCTION ----------------

async function buyTokens(amount){
  try{
    const {provider,signer}=await connectWallet();
    const contract=new ethers.Contract(PRESALE_ADDRESS,PRESALE_ABI,signer);

    const tx=await contract.buyTokens({value:ethers.utils.parseEther(amount)});
    const receipt=await tx.wait();

    alert("âœ… Purchase successful!\n\nTX Hash:\n"+receipt.transactionHash);

  }catch(e){
    console.error(e);
    alert("âŒ Transaction Failed");
  }
}

// ---------------- UI COMPONENT ----------------

function App(){
  const[wallet,setWallet]=useState(null);
  const[matic,setMatic]=useState("");
  const[lucy,setLucy]=useState(0);
  const[loading,setLoading]=useState(false);

  useEffect(()=>{setLucy(matic?matic*RATE:0)},[matic]);

  async function connect(){
    const w=await connectWallet();
    setWallet(w.addr);
  }

  async function contribute(e){
    e.preventDefault();
    if(!wallet) return alert("Connect wallet first");
    if(matic<=0) return alert("Invalid Amount");

    setLoading(true);
    await buyTokens(matic);
    setLoading(false);
  }

  return (
    <div class="max-w-3xl mx-auto pt-12 p-6 text-center">

      <h1 class="text-4xl font-extrabold bg-clip-text text-transparent 
                 bg-gradient-to-r from-green-400 to-yellow-300">
        LUCIDIFY PRESALE
      </h1>
      <p class="mt-2 text-gray-300">Buy $LUCY early â€” powered by Polygon</p>

      <div class="glass mt-8 p-6 rounded-2xl">

        <button onclick={connect} 
          class="w-full py-3 rounded-lg font-bold text-black 
                 bg-gradient-to-r from-green-400 to-yellow-300">
          {wallet ? "Connected: "+wallet.slice(0,6)+"..." : "Connect Wallet"}
        </button>

        <form onsubmit={contribute} class="mt-5 space-y-4">

          <input type="number" min="0" step="0.1"
            value={matic} onInput={(e)=>setMatic(e.target.value)}
            class="w-full p-3 rounded-lg bg-black/40 border border-white/20"
            placeholder="Enter MATIC amount"/>

          <div class="text-gray-300">
            You Receive: 
            <span class="text-yellow-300 font-bold"> {lucy} LUCY</span>
          </div>

          <button type="submit" disabled={loading||!wallet}
            class="w-full py-3 rounded-lg font-bold border border-green-400 
                   hover:bg-green-400 hover:text-black transition">
            {loading? "Processing..." : "ðŸš€ Buy LUCY"}
          </button>

        </form>
      </div>

      <p class="mt-10 text-xs text-gray-400">
        Contract Secured Â· No Mint Â· Fixed Supply 85M Â· Deflationary
      </p>
    </div>
  )
}

// --------- Render App ---------
ReactDOM.render(<App/>,document.getElementById("root"));

</script>
</body>
</html>
